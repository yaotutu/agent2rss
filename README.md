# Agent2RSS

ä¸€ä¸ªåŸºäº Bun + ElysiaJS çš„é«˜æ€§èƒ½ RSS å¾®æœåŠ¡ï¼ŒAI Agent é€šè¿‡ Webhook å‘é€å†…å®¹ï¼ŒæœåŠ¡ç«¯è‡ªåŠ¨ç”Ÿæˆ RSS feedã€‚

## åŠŸèƒ½ç‰¹æ€§

- âš¡ **é«˜æ€§èƒ½**: åŸºäº Bun è¿è¡Œæ—¶å’Œ ElysiaJS æ¡†æ¶
- ğŸ”’ **å®‰å…¨é‰´æƒ**: ä½¿ç”¨ Token éªŒè¯ Webhook è¯·æ±‚
- ğŸ“ **Markdown æ”¯æŒ**: è‡ªåŠ¨å°† Markdown è½¬æ¢ä¸º HTML
- ğŸ“° **RSS 2.0**: ç”Ÿæˆæ ‡å‡† RSS 2.0 æ ¼å¼çš„ feed
- ğŸ’¾ **æ»šåŠ¨å­˜å‚¨**: è‡ªåŠ¨ä¿ç•™æœ€æ–° 100 æ¡è®°å½•
- ğŸ·ï¸ **æ ‡ç­¾æ”¯æŒ**: æ”¯æŒæ–‡ç« æ ‡ç­¾å’Œä½œè€…ä¿¡æ¯
- ğŸ“Š **è‡ªåŠ¨æ‘˜è¦**: è‡ªåŠ¨ç”Ÿæˆæ–‡ç« æ‘˜è¦ï¼ˆ150 å­—ç¬¦ï¼‰

## æŠ€æœ¯æ ˆ

- **è¿è¡Œæ—¶**: [Bun](https://bun.sh/) - å¿«é€Ÿçš„ JavaScript è¿è¡Œæ—¶
- **Web æ¡†æ¶**: [ElysiaJS](https://elysiajs.com/) - é«˜æ€§èƒ½ TypeScript æ¡†æ¶
- **RSS ç”Ÿæˆ**: [feed](https://github.com/jpmonette/feed) - RSS/Atom feed ç”Ÿæˆå™¨
- **Markdown è§£æ**: [markdown-it](https://github.com/markdown-it/markdown-it) - Markdown è§£æå™¨
- **è¯­è¨€**: TypeScript

## å®‰è£…æ­¥éª¤

### 1. å®‰è£… Bun

å¦‚æœè¿˜æ²¡æœ‰å®‰è£… Bunï¼Œè¯·å…ˆå®‰è£…ï¼š

```bash
curl -fsSL https://bun.sh/install | bash
```

### 2. å…‹éš†é¡¹ç›®

```bash
git clone <your-repo-url>
cd agent2rss
```

### 3. å®‰è£…ä¾èµ–

```bash
bun install
```

### 4. é…ç½®ç¯å¢ƒå˜é‡

```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œè®¾ç½®ä½ çš„é…ç½®ï¼š

```env
# æœåŠ¡é…ç½®
PORT=8765

# RSS é¢‘é“é…ç½®
FEED_TITLE=AI Briefing
FEED_DESCRIPTION=Daily news summaries generated by AI.
FEED_URL=http://localhost:8765

# å®‰å…¨é…ç½®ï¼ˆå¿…é¡»ä¿®æ”¹ï¼ï¼‰
AUTH_TOKEN=your-secret-token-here
```

âš ï¸ **é‡è¦**: è¯·åŠ¡å¿…ä¿®æ”¹ `AUTH_TOKEN` ä¸ºä¸€ä¸ªå¼ºå¯†ç ï¼

### 5. å¯åŠ¨æœåŠ¡

å¼€å‘æ¨¡å¼ï¼ˆæ”¯æŒçƒ­é‡è½½ï¼‰ï¼š

```bash
bun run dev
```

ç”Ÿäº§æ¨¡å¼ï¼š

```bash
bun run start
```

æœåŠ¡å¯åŠ¨åï¼Œä½ ä¼šçœ‹åˆ°ï¼š

```
ğŸš€ Agent2RSS is running at :::8765
ğŸ“¡ Webhook endpoint: POST http://localhost:8765/api/webhook
ğŸ“° RSS feed: GET http://localhost:8765/rss.xml
```

## API æ–‡æ¡£

### POST /api/webhook

æ¥æ”¶ AI Agent å‘é€çš„æ–°é—»å†…å®¹ã€‚

**è¯·æ±‚å¤´**:
- `Content-Type: application/json`
- `X-Auth-Token: <your-auth-token>`

**è¯·æ±‚ä½“**:

```json
{
  "title": "æ–‡ç« æ ‡é¢˜",
  "link": "https://example.com/article",
  "content": "# Markdown æ ¼å¼çš„å†…å®¹\n\nè¿™æ˜¯ä¸€æ®µ**åŠ ç²—**çš„æ–‡æœ¬ã€‚",
  "tags": ["AI", "æŠ€æœ¯"],
  "author": "AI Agent"
}
```

**å­—æ®µè¯´æ˜**:
- `title` (å¿…éœ€): æ–‡ç« æ ‡é¢˜
- `link` (å¿…éœ€): æ–‡ç« é“¾æ¥
- `content` (å¿…éœ€): Markdown æ ¼å¼çš„æ–‡ç« å†…å®¹
- `tags` (å¯é€‰): æ ‡ç­¾æ•°ç»„
- `author` (å¯é€‰): ä½œè€…åç§°

**å“åº”ç¤ºä¾‹**:

æˆåŠŸ (200):
```json
{
  "success": true,
  "message": "Post added successfully",
  "post": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "title": "æ–‡ç« æ ‡é¢˜",
    "pubDate": "2024-01-01T12:00:00.000Z"
  }
}
```

å¤±è´¥ (401):
```json
{
  "error": "Unauthorized"
}
```

å¤±è´¥ (400):
```json
{
  "error": "Validation error message"
}
```

### GET /rss.xml

è·å– RSS 2.0 æ ¼å¼çš„ feedã€‚

**å“åº”å¤´**:
- `Content-Type: application/xml; charset=utf-8`

**å“åº”ç¤ºä¾‹**:

```xml
<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
  <channel>
    <title>AI Briefing</title>
    <description>Daily news summaries generated by AI.</description>
    <link>http://localhost:8765</link>
    <item>
      <title>æ–‡ç« æ ‡é¢˜</title>
      <link>https://example.com/article</link>
      <guid>https://example.com/article</guid>
      <description>æ–‡ç« æ‘˜è¦...</description>
      <content:encoded><![CDATA[<h1>Markdown æ ¼å¼çš„å†…å®¹</h1>...]]></content:encoded>
      <pubDate>Mon, 01 Jan 2024 12:00:00 GMT</pubDate>
      <author>AI Agent</author>
      <category>AI</category>
      <category>æŠ€æœ¯</category>
    </item>
  </channel>
</rss>
```

## ä½¿ç”¨ç¤ºä¾‹

### ä½¿ç”¨ curl å‘é€å†…å®¹

```bash
curl -X POST http://localhost:8765/api/webhook \
  -H "Content-Type: application/json" \
  -H "X-Auth-Token: your-secret-token-here" \
  -d '{
    "title": "AI æŠ€æœ¯æœ€æ–°è¿›å±•",
    "link": "https://example.com/ai-news",
    "content": "# AI æŠ€æœ¯çªç ´\n\nä»Šå¤©ï¼ŒAI é¢†åŸŸå–å¾—äº†**é‡å¤§çªç ´**ã€‚\n\n## ä¸»è¦äº®ç‚¹\n\n- æ€§èƒ½æå‡ 50%\n- æˆæœ¬é™ä½ 30%\n- æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ",
    "tags": ["AI", "æŠ€æœ¯", "åˆ›æ–°"],
    "author": "AI Reporter"
  }'
```

### è®¢é˜… RSS Feed

åœ¨ä½ çš„ RSS é˜…è¯»å™¨ä¸­æ·»åŠ ä»¥ä¸‹ URLï¼š

```
http://localhost:8765/rss.xml
```

æ¨èçš„ RSS é˜…è¯»å™¨ï¼š
- [Feedly](https://feedly.com/)
- [Inoreader](https://www.inoreader.com/)
- [NetNewsWire](https://netnewswireapp.com/) (macOS/iOS)
- [Reeder](https://reederapp.com/) (macOS/iOS)

### ä½¿ç”¨ JavaScript/TypeScript å‘é€å†…å®¹

```typescript
async function sendToRSS(post: {
  title: string;
  link: string;
  content: string;
  tags?: string[];
  author?: string;
}) {
  const response = await fetch('http://localhost:8765/api/webhook', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'X-Auth-Token': 'your-secret-token-here'
    },
    body: JSON.stringify(post)
  });

  return await response.json();
}

// ä½¿ç”¨ç¤ºä¾‹
await sendToRSS({
  title: 'æµ‹è¯•æ–‡ç« ',
  link: 'https://example.com/test',
  content: '# æ ‡é¢˜\n\nè¿™æ˜¯å†…å®¹ã€‚',
  tags: ['æµ‹è¯•'],
  author: 'Bot'
});
```

## å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„

```
agent2rss/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ index.ts          # ä¸»åº”ç”¨æ–‡ä»¶
â”œâ”€â”€ data/
â”‚   â””â”€â”€ posts.json        # æ•°æ®å­˜å‚¨ï¼ˆè¿è¡Œæ—¶è‡ªåŠ¨åˆ›å»ºï¼‰
â”œâ”€â”€ package.json          # é¡¹ç›®é…ç½®
â”œâ”€â”€ tsconfig.json         # TypeScript é…ç½®
â”œâ”€â”€ .env.example          # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ .env                  # æœ¬åœ°ç¯å¢ƒå˜é‡ï¼ˆä¸æäº¤åˆ° Gitï¼‰
â””â”€â”€ README.md             # é¡¹ç›®æ–‡æ¡£
```

### æ•°æ®å­˜å‚¨

æ•°æ®å­˜å‚¨åœ¨ `data/posts.json` æ–‡ä»¶ä¸­ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š

```json
[
  {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "title": "æ–‡ç« æ ‡é¢˜",
    "link": "https://example.com/article",
    "content": "<h1>HTML æ ¼å¼çš„å†…å®¹</h1>",
    "contentMarkdown": "# Markdown æ ¼å¼çš„å†…å®¹",
    "summary": "æ–‡ç« æ‘˜è¦ï¼ˆå‰ 150 å­—ç¬¦ï¼‰...",
    "tags": ["AI", "æŠ€æœ¯"],
    "author": "AI Agent",
    "pubDate": "2024-01-01T12:00:00.000Z"
  }
]
```

### æ»šåŠ¨å­˜å‚¨ç­–ç•¥

- æ–°å†…å®¹æ€»æ˜¯æ·»åŠ åˆ°æ•°ç»„å¼€å¤´
- è‡ªåŠ¨ä¿ç•™æœ€æ–°çš„ 100 æ¡è®°å½•
- è¶…è¿‡ 100 æ¡çš„æ—§è®°å½•ä¼šè¢«è‡ªåŠ¨åˆ é™¤

### æ‰©å±•å»ºè®®

1. **æ·»åŠ æ•°æ®åº“æ”¯æŒ**: å¯¹äºå¤§è§„æ¨¡ä½¿ç”¨ï¼Œå¯ä»¥è¿ç§»åˆ° SQLiteã€PostgreSQL ç­‰æ•°æ®åº“
2. **æ·»åŠ åˆ†é¡µ**: ä¸º RSS feed æ·»åŠ åˆ†é¡µæ”¯æŒ
3. **æ·»åŠ è¿‡æ»¤**: æ”¯æŒæŒ‰æ ‡ç­¾ã€ä½œè€…è¿‡æ»¤å†…å®¹
4. **æ·»åŠ æœç´¢**: å®ç°å…¨æ–‡æœç´¢åŠŸèƒ½
5. **æ·»åŠ é€Ÿç‡é™åˆ¶**: é˜²æ­¢ API æ»¥ç”¨
6. **æ·»åŠ æ—¥å¿—**: ä½¿ç”¨ç»“æ„åŒ–æ—¥å¿—è®°å½•è¯·æ±‚

## å®‰å…¨å»ºè®®

1. **ä½¿ç”¨å¼ºå¯†ç **: `AUTH_TOKEN` åº”è¯¥æ˜¯ä¸€ä¸ªé•¿ä¸”éšæœºçš„å­—ç¬¦ä¸²
2. **ä½¿ç”¨ HTTPS**: ç”Ÿäº§ç¯å¢ƒåŠ¡å¿…ä½¿ç”¨ HTTPS
3. **æ·»åŠ é€Ÿç‡é™åˆ¶**: é˜²æ­¢æš´åŠ›ç ´è§£å’Œ DDoS æ”»å‡»
4. **å®šæœŸå¤‡ä»½**: å®šæœŸå¤‡ä»½ `data/posts.json` æ–‡ä»¶
5. **ç›‘æ§æ—¥å¿—**: ç›‘æ§å¼‚å¸¸è¯·æ±‚å’Œé”™è¯¯æ—¥å¿—

## éƒ¨ç½²

### ä½¿ç”¨ Docker

åˆ›å»º `Dockerfile`:

```dockerfile
FROM oven/bun:1

WORKDIR /app

COPY package.json bun.lockb ./
RUN bun install --frozen-lockfile

COPY . .

EXPOSE 8765

CMD ["bun", "run", "start"]
```

æ„å»ºå¹¶è¿è¡Œï¼š

```bash
docker build -t agent2rss .
docker run -p 8765:8765 --env-file .env agent2rss
```

### ä½¿ç”¨ PM2

```bash
# å®‰è£… PM2
bun add -g pm2

# å¯åŠ¨æœåŠ¡
pm2 start "bun run start" --name agent2rss

# æŸ¥çœ‹çŠ¶æ€
pm2 status

# æŸ¥çœ‹æ—¥å¿—
pm2 logs agent2rss
```

## æ•…éšœæ’é™¤

### é—®é¢˜ï¼šæ— æ³•å¯åŠ¨æœåŠ¡

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ Bun æ˜¯å¦æ­£ç¡®å®‰è£…ï¼š`bun --version`
2. æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨ï¼š`lsof -i :8765`
3. æ£€æŸ¥ç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®é…ç½®

### é—®é¢˜ï¼šWebhook è¿”å› 401

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ `X-Auth-Token` è¯·æ±‚å¤´æ˜¯å¦æ­£ç¡®
2. æ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„ `AUTH_TOKEN` æ˜¯å¦è®¾ç½®
3. ç¡®ä¿ token æ²¡æœ‰å¤šä½™çš„ç©ºæ ¼æˆ–æ¢è¡Œç¬¦

### é—®é¢˜ï¼šRSS feed ä¸ºç©º

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ `data/posts.json` æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”åŒ…å«æ•°æ®
2. æ£€æŸ¥æ–‡ä»¶æƒé™æ˜¯å¦æ­£ç¡®
3. æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯

## è®¸å¯è¯

MIT

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ GitHub Issues è”ç³»ã€‚
