# Agent2RSS API æ–‡æ¡£

## ğŸ“‹ ç›®å½•

- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [è®¤è¯æ–¹å¼](#è®¤è¯æ–¹å¼)
- [API ç«¯ç‚¹](#api-ç«¯ç‚¹)
  - [å‘é€å†…å®¹åˆ° RSS](#1-å‘é€å†…å®¹åˆ°-rss)
  - [è·å– RSS Feed](#2-è·å–-rss-feed)
- [ä»£ç ç¤ºä¾‹](#ä»£ç ç¤ºä¾‹)
- [é”™è¯¯å¤„ç†](#é”™è¯¯å¤„ç†)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨æœåŠ¡

```bash
bun run dev
```

æœåŠ¡å¯åŠ¨åä¼šæ˜¾ç¤ºï¼š

```
ğŸš€ Agent2RSS is running on port 8765

ğŸ“° RSS Feed URLs:
   Local:  http://localhost:8765/rss.xml
   LAN:    http://192.168.x.x:8765/rss.xml

ğŸ“¡ Webhook endpoint:
   POST http://localhost:8765/api/webhook
```

### 2. é…ç½®è®¤è¯ Token

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œè®¾ç½®ä½ çš„è®¤è¯ Tokenï¼š

```env
AUTH_TOKEN=your-secret-token-here
```

âš ï¸ **é‡è¦**ï¼šè¯·ä½¿ç”¨å¼ºå¯†ç ä½œä¸º Tokenï¼

---

## è®¤è¯æ–¹å¼

æ‰€æœ‰ Webhook è¯·æ±‚å¿…é¡»åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«è®¤è¯ Tokenï¼š

```
X-Auth-Token: your-secret-token-here
```

å¦‚æœ Token ä¸æ­£ç¡®æˆ–ç¼ºå¤±ï¼Œå°†è¿”å› `401 Unauthorized` é”™è¯¯ã€‚

---

## API ç«¯ç‚¹

### 1. å‘é€å†…å®¹åˆ° RSS

**ç«¯ç‚¹**: `POST /api/webhook`

**æè¿°**: æ¥æ”¶ AI Agent æˆ–å…¶ä»–æœåŠ¡å‘é€çš„å†…å®¹ï¼Œè‡ªåŠ¨è½¬æ¢ Markdown ä¸º HTMLï¼Œå¹¶æ·»åŠ åˆ° RSS feedã€‚

#### è¯·æ±‚å¤´

| å­—æ®µ | å€¼ | å¿…éœ€ |
|------|-----|------|
| Content-Type | application/json | âœ… |
| X-Auth-Token | ä½ çš„è®¤è¯ Token | âœ… |

#### è¯·æ±‚ä½“

| å­—æ®µ | ç±»å‹ | å¿…éœ€ | è¯´æ˜ |
|------|------|------|------|
| title | string | âœ… | æ–‡ç« æ ‡é¢˜ |
| link | string | âœ… | æ–‡ç« é“¾æ¥ï¼ˆä½œä¸ºå”¯ä¸€æ ‡è¯†ï¼‰ |
| content | string | âœ… | Markdown æ ¼å¼çš„æ–‡ç« å†…å®¹ |
| tags | string[] | âŒ | æ ‡ç­¾æ•°ç»„ |
| author | string | âŒ | ä½œè€…åç§° |

#### è¯·æ±‚ç¤ºä¾‹

```bash
curl -X POST http://localhost:8765/api/webhook \
  -H "Content-Type: application/json" \
  -H "X-Auth-Token: your-secret-token-here" \
  -d '{
    "title": "AI æŠ€æœ¯æœ€æ–°è¿›å±•",
    "link": "https://example.com/ai-news-2024",
    "content": "# AI æŠ€æœ¯çªç ´\n\nä»Šå¤©ï¼ŒAI é¢†åŸŸå–å¾—äº†**é‡å¤§çªç ´**ã€‚\n\n## ä¸»è¦äº®ç‚¹\n\n- æ€§èƒ½æå‡ 50%\n- æˆæœ¬é™ä½ 30%\n- æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ",
    "tags": ["AI", "æŠ€æœ¯", "åˆ›æ–°"],
    "author": "AI Reporter"
  }'
```

#### æˆåŠŸå“åº” (200 OK)

```json
{
  "success": true,
  "message": "Post added successfully",
  "post": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "title": "AI æŠ€æœ¯æœ€æ–°è¿›å±•",
    "pubDate": "2026-02-05T12:00:00.000Z"
  }
}
```

#### é”™è¯¯å“åº”

**401 Unauthorized** - Token é”™è¯¯æˆ–ç¼ºå¤±

```json
{
  "error": "Unauthorized"
}
```

**400 Bad Request** - è¯·æ±‚ä½“éªŒè¯å¤±è´¥

```json
{
  "error": "Validation error message"
}
```

**500 Internal Server Error** - æœåŠ¡å™¨é”™è¯¯

```json
{
  "error": "Internal server error"
}
```

---

### 2. è·å– RSS Feed

**ç«¯ç‚¹**: `GET /rss.xml`

**æè¿°**: è·å–æ ‡å‡† RSS 2.0 æ ¼å¼çš„ feedï¼ŒåŒ…å«æ‰€æœ‰å·²å‘å¸ƒçš„å†…å®¹ï¼ˆæœ€å¤š 100 æ¡ï¼‰ã€‚

#### è¯·æ±‚ç¤ºä¾‹

```bash
curl http://localhost:8765/rss.xml
```

#### å“åº”ç¤ºä¾‹

```xml
<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>AI Briefing</title>
    <link>http://localhost:8765</link>
    <description>Daily news summaries generated by AI.</description>
    <language>zh-CN</language>

    <item>
      <title><![CDATA[AI æŠ€æœ¯æœ€æ–°è¿›å±•]]></title>
      <link>https://example.com/ai-news-2024</link>
      <guid>https://example.com/ai-news-2024</guid>
      <pubDate>Wed, 05 Feb 2026 12:00:00 GMT</pubDate>
      <description><![CDATA[AIæŠ€æœ¯çªç ´ ä»Šå¤©ï¼ŒAIé¢†åŸŸå–å¾—äº†é‡å¤§çªç ´ã€‚ ä¸»è¦äº®ç‚¹ æ€§èƒ½æå‡50% æˆæœ¬é™ä½30% æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ]]></description>
      <content:encoded><![CDATA[
        <h1>AIæŠ€æœ¯çªç ´</h1>
        <p>ä»Šå¤©ï¼ŒAIé¢†åŸŸå–å¾—äº†<strong>é‡å¤§çªç ´</strong>ã€‚</p>
        <h2>ä¸»è¦äº®ç‚¹</h2>
        <ul>
          <li>æ€§èƒ½æå‡50%</li>
          <li>æˆæœ¬é™ä½30%</li>
          <li>æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ</li>
        </ul>
      ]]></content:encoded>
      <category>AI</category>
      <category>æŠ€æœ¯</category>
      <category>åˆ›æ–°</category>
    </item>

  </channel>
</rss>
```

#### å“åº”å¤´

```
Content-Type: application/xml; charset=utf-8
```

---

## ä»£ç ç¤ºä¾‹

### JavaScript / TypeScript

```javascript
// å‘é€å†…å®¹åˆ° RSS
async function sendToRSS(post) {
  const response = await fetch('http://localhost:8765/api/webhook', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'X-Auth-Token': 'your-secret-token-here'
    },
    body: JSON.stringify({
      title: post.title,
      link: post.link,
      content: post.content,
      tags: post.tags,
      author: post.author
    })
  });

  if (!response.ok) {
    throw new Error(`HTTP error! status: ${response.status}`);
  }

  return await response.json();
}

// ä½¿ç”¨ç¤ºä¾‹
const result = await sendToRSS({
  title: 'æµ‹è¯•æ–‡ç« ',
  link: 'https://example.com/test',
  content: '# æ ‡é¢˜\n\nè¿™æ˜¯å†…å®¹ã€‚',
  tags: ['æµ‹è¯•'],
  author: 'Bot'
});

console.log(result);
// { success: true, message: "Post added successfully", post: {...} }
```

### Python

```python
import requests
import json

def send_to_rss(post):
    url = 'http://localhost:8765/api/webhook'
    headers = {
        'Content-Type': 'application/json',
        'X-Auth-Token': 'your-secret-token-here'
    }

    response = requests.post(url, headers=headers, json=post)
    response.raise_for_status()

    return response.json()

# ä½¿ç”¨ç¤ºä¾‹
result = send_to_rss({
    'title': 'æµ‹è¯•æ–‡ç« ',
    'link': 'https://example.com/test',
    'content': '# æ ‡é¢˜\n\nè¿™æ˜¯å†…å®¹ã€‚',
    'tags': ['æµ‹è¯•'],
    'author': 'Bot'
})

print(result)
# {'success': True, 'message': 'Post added successfully', 'post': {...}}
```

### Node.js (ä½¿ç”¨ axios)

```javascript
const axios = require('axios');

async function sendToRSS(post) {
  try {
    const response = await axios.post(
      'http://localhost:8765/api/webhook',
      post,
      {
        headers: {
          'Content-Type': 'application/json',
          'X-Auth-Token': 'your-secret-token-here'
        }
      }
    );

    return response.data;
  } catch (error) {
    console.error('Error:', error.response?.data || error.message);
    throw error;
  }
}

// ä½¿ç”¨ç¤ºä¾‹
sendToRSS({
  title: 'æµ‹è¯•æ–‡ç« ',
  link: 'https://example.com/test',
  content: '# æ ‡é¢˜\n\nè¿™æ˜¯å†…å®¹ã€‚',
  tags: ['æµ‹è¯•'],
  author: 'Bot'
}).then(result => {
  console.log(result);
});
```

### Go

```go
package main

import (
    "bytes"
    "encoding/json"
    "fmt"
    "net/http"
)

type Post struct {
    Title   string   `json:"title"`
    Link    string   `json:"link"`
    Content string   `json:"content"`
    Tags    []string `json:"tags,omitempty"`
    Author  string   `json:"author,omitempty"`
}

func sendToRSS(post Post) error {
    jsonData, err := json.Marshal(post)
    if err != nil {
        return err
    }

    req, err := http.NewRequest("POST", "http://localhost:8765/api/webhook", bytes.NewBuffer(jsonData))
    if err != nil {
        return err
    }

    req.Header.Set("Content-Type", "application/json")
    req.Header.Set("X-Auth-Token", "your-secret-token-here")

    client := &http.Client{}
    resp, err := client.Do(req)
    if err != nil {
        return err
    }
    defer resp.Body.Close()

    if resp.StatusCode != http.StatusOK {
        return fmt.Errorf("HTTP error: %d", resp.StatusCode)
    }

    return nil
}

func main() {
    post := Post{
        Title:   "æµ‹è¯•æ–‡ç« ",
        Link:    "https://example.com/test",
        Content: "# æ ‡é¢˜\n\nè¿™æ˜¯å†…å®¹ã€‚",
        Tags:    []string{"æµ‹è¯•"},
        Author:  "Bot",
    }

    if err := sendToRSS(post); err != nil {
        fmt.Println("Error:", err)
    } else {
        fmt.Println("Success!")
    }
}
```

---

## é”™è¯¯å¤„ç†

### å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ

| é”™è¯¯ä»£ç  | é”™è¯¯ä¿¡æ¯ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|---------|---------|------|---------|
| 401 | Unauthorized | Token é”™è¯¯æˆ–ç¼ºå¤± | æ£€æŸ¥ `X-Auth-Token` è¯·æ±‚å¤´æ˜¯å¦æ­£ç¡® |
| 400 | Validation error | è¯·æ±‚ä½“æ ¼å¼é”™è¯¯ | æ£€æŸ¥å¿…éœ€å­—æ®µæ˜¯å¦éƒ½æä¾›äº† |
| 500 | Internal server error | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ | æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—ï¼Œæ£€æŸ¥æ–‡ä»¶æƒé™ |

### é”™è¯¯å¤„ç†ç¤ºä¾‹

```javascript
async function sendToRSSWithErrorHandling(post) {
  try {
    const response = await fetch('http://localhost:8765/api/webhook', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-Auth-Token': 'your-secret-token-here'
      },
      body: JSON.stringify(post)
    });

    const data = await response.json();

    if (!response.ok) {
      switch (response.status) {
        case 401:
          console.error('è®¤è¯å¤±è´¥ï¼šToken é”™è¯¯');
          break;
        case 400:
          console.error('è¯·æ±‚æ ¼å¼é”™è¯¯ï¼š', data.error);
          break;
        case 500:
          console.error('æœåŠ¡å™¨é”™è¯¯ï¼š', data.error);
          break;
        default:
          console.error('æœªçŸ¥é”™è¯¯ï¼š', response.status);
      }
      throw new Error(data.error || 'Request failed');
    }

    return data;
  } catch (error) {
    console.error('å‘é€å¤±è´¥ï¼š', error.message);
    throw error;
  }
}
```

---

## å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•åœ¨ RSS é˜…è¯»å™¨ä¸­è®¢é˜…ï¼Ÿ

**A**: åœ¨ä½ çš„ RSS é˜…è¯»å™¨ä¸­æ·»åŠ ä»¥ä¸‹ URLï¼š

- æœ¬åœ°è®¿é—®ï¼š`http://localhost:8765/rss.xml`
- å±€åŸŸç½‘è®¿é—®ï¼š`http://<ä½ çš„å±€åŸŸç½‘IP>:8765/rss.xml`
- å…¬ç½‘è®¿é—®ï¼š`http://<ä½ çš„å…¬ç½‘IP>:8765/rss.xml`

æ¨èçš„ RSS é˜…è¯»å™¨ï¼š
- [Feedly](https://feedly.com/)
- [Inoreader](https://www.inoreader.com/)
- [NetNewsWire](https://netnewswireapp.com/) (macOS/iOS)
- [Reeder](https://reederapp.com/) (macOS/iOS)

### Q2: æœ€å¤šå¯ä»¥å­˜å‚¨å¤šå°‘æ¡å†…å®¹ï¼Ÿ

**A**: æœåŠ¡é‡‡ç”¨æ»šåŠ¨å­˜å‚¨ç­–ç•¥ï¼Œè‡ªåŠ¨ä¿ç•™æœ€æ–°çš„ 100 æ¡è®°å½•ã€‚è¶…è¿‡ 100 æ¡æ—¶ï¼Œæœ€æ—§çš„è®°å½•ä¼šè¢«è‡ªåŠ¨åˆ é™¤ã€‚

### Q3: æ”¯æŒå“ªäº› Markdown è¯­æ³•ï¼Ÿ

**A**: æ”¯æŒæ ‡å‡† Markdown è¯­æ³•ï¼ŒåŒ…æ‹¬ï¼š
- æ ‡é¢˜ (`#`, `##`, `###`)
- åŠ ç²— (`**text**`)
- æ–œä½“ (`*text*`)
- åˆ—è¡¨ (`-`, `1.`)
- é“¾æ¥ (`[text](url)`)
- ä»£ç å— (` ``` `)
- å¼•ç”¨ (`>`)
- ç­‰ç­‰

### Q4: å¦‚ä½•ä¿®æ”¹ RSS é¢‘é“ä¿¡æ¯ï¼Ÿ

**A**: ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```env
FEED_TITLE=ä½ çš„é¢‘é“æ ‡é¢˜
FEED_DESCRIPTION=ä½ çš„é¢‘é“æè¿°
FEED_URL=http://your-domain.com
```

### Q5: å¯ä»¥åŒæ—¶å‘é€å¤šæ¡å†…å®¹å—ï¼Ÿ

**A**: å¯ä»¥ã€‚æ¯æ¬¡è°ƒç”¨ webhook ç«¯ç‚¹éƒ½ä¼šæ·»åŠ ä¸€æ¡æ–°å†…å®¹ã€‚ä½ å¯ä»¥å¹¶å‘å‘é€å¤šä¸ªè¯·æ±‚ï¼ŒæœåŠ¡ä¼šæŒ‰æ¥æ”¶é¡ºåºå¤„ç†ã€‚

### Q6: å¦‚ä½•å¤‡ä»½æ•°æ®ï¼Ÿ

**A**: æ•°æ®å­˜å‚¨åœ¨ `data/posts.json` æ–‡ä»¶ä¸­ï¼Œå®šæœŸå¤‡ä»½è¿™ä¸ªæ–‡ä»¶å³å¯ï¼š

```bash
cp data/posts.json data/posts.json.backup
```

### Q7: å¦‚ä½•æ¸…ç©ºæ‰€æœ‰å†…å®¹ï¼Ÿ

**A**: åˆ é™¤æˆ–æ¸…ç©º `data/posts.json` æ–‡ä»¶ï¼š

```bash
rm data/posts.json
# æˆ–
echo "[]" > data/posts.json
```

### Q8: æ”¯æŒå›¾ç‰‡å—ï¼Ÿ

**A**: æ”¯æŒã€‚åœ¨ Markdown å†…å®¹ä¸­ä½¿ç”¨æ ‡å‡†çš„å›¾ç‰‡è¯­æ³•ï¼š

```markdown
![å›¾ç‰‡æè¿°](https://example.com/image.jpg)
```

å›¾ç‰‡ä¼šè¢«è½¬æ¢ä¸º HTML `<img>` æ ‡ç­¾ï¼Œåœ¨ RSS é˜…è¯»å™¨ä¸­æ˜¾ç¤ºã€‚

### Q9: å¦‚ä½•åœ¨ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ï¼Ÿ

**A**: å»ºè®®ä½¿ç”¨ä»¥ä¸‹æ–¹å¼ï¼š

1. **ä½¿ç”¨åå‘ä»£ç†ï¼ˆæ¨èï¼‰**ï¼š
   - ä½¿ç”¨ Nginx æˆ– Caddy ä½œä¸ºåå‘ä»£ç†
   - é…ç½® HTTPS
   - æ·»åŠ é€Ÿç‡é™åˆ¶

2. **ä½¿ç”¨ PM2 ç®¡ç†è¿›ç¨‹**ï¼š
   ```bash
   pm2 start "bun run start" --name agent2rss
   ```

3. **ä½¿ç”¨ Docker**ï¼š
   å‚è€ƒ README.md ä¸­çš„ Docker éƒ¨ç½²è¯´æ˜

### Q10: å¦‚ä½•é™åˆ¶è®¿é—®æ¥æºï¼Ÿ

**A**: å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼é™åˆ¶ï¼š

1. **é˜²ç«å¢™è§„åˆ™**ï¼šåªå…è®¸ç‰¹å®š IP è®¿é—®
2. **åå‘ä»£ç†**ï¼šåœ¨ Nginx ä¸­é…ç½® IP ç™½åå•
3. **ä¿®æ”¹ä»£ç **ï¼šåœ¨ webhook ç«¯ç‚¹æ·»åŠ  IP æ£€æŸ¥é€»è¾‘

---

## æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- GitHub Issues: [é¡¹ç›®åœ°å€]
- æ–‡æ¡£ï¼šæŸ¥çœ‹ `README.md`

---

**æœ€åæ›´æ–°**: 2026-02-05
