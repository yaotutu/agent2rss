# Agent2RSS å¤šé¢‘é“ä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

Agent2RSS 2.0 ç°åœ¨æ”¯æŒå¤šä¸ªç‹¬ç«‹çš„ RSS Feed é¢‘é“ï¼Œæ¯ä¸ªé¢‘é“æœ‰ç‹¬ç«‹çš„é…ç½®å’Œæ–‡ç« ã€‚

## æ ¸å¿ƒæ¦‚å¿µ

### é¢‘é“ (Channel)
é¢‘é“æ˜¯ç‹¬ç«‹çš„å†…å®¹å®¹å™¨ï¼Œæ¯ä¸ªé¢‘é“æœ‰ï¼š
- å”¯ä¸€ IDï¼ˆç”¨äº URL è·¯å¾„ï¼‰
- æ˜¾ç¤ºåç§°
- æè¿°
- ç‹¬ç«‹çš„ä¸»é¢˜è®¾ç½®
- ç‹¬ç«‹çš„æ–‡ç« åˆ—è¡¨

### å·¥ä½œæµç¨‹
1. **ä¸€æ¬¡æ€§è®¾ç½®**ï¼šé€šè¿‡ API åˆ›å»ºé¢‘é“
2. **é‡å¤ä½¿ç”¨**ï¼šå‘å¸ƒæ–‡ç« æ—¶åªéœ€æŒ‡å®šé¢‘é“ ID
3. **è®¢é˜… RSS**ï¼šé€šè¿‡ URL è®¿é—®å¯¹åº”é¢‘é“çš„ RSS Feed

---

## API æ¥å£

### 1. åˆ›å»ºé¢‘é“

**ç«¯ç‚¹**: `POST /api/channels`

**é‰´æƒ**: éœ€è¦å…¨å±€ `X-Auth-Token`

**è¯·æ±‚ä½“**:
```json
{
  "id": "tech",              // å¿…å¡«ï¼Œé¢‘é“å”¯ä¸€æ ‡è¯†
  "name": "ç§‘æŠ€é¢‘é“",         // å¿…å¡«ï¼Œæ˜¾ç¤ºåç§°
  "description": "æœ€æ–°ç§‘æŠ€èµ„è®¯", // å¿…å¡«ï¼ŒRSS æè¿°
  "theme": "github",         // å¯é€‰ï¼Œä¸»é¢˜ï¼ˆé»˜è®¤ï¼šspringï¼‰
  "language": "zh-CN",       // å¯é€‰ï¼Œè¯­è¨€ï¼ˆé»˜è®¤ï¼šzh-CNï¼‰
  "maxPosts": 50             // å¯é€‰ï¼Œæœ€å¤§æ–‡ç« æ•°ï¼ˆé»˜è®¤ï¼š100ï¼‰
}
```

**ç¤ºä¾‹**:
```bash
curl -X POST http://localhost:8765/api/channels \
  -H "Content-Type: application/json" \
  -H "X-Auth-Token: your-token" \
  -d '{
    "id": "tech",
    "name": "ç§‘æŠ€é¢‘é“",
    "description": "æœ€æ–°ç§‘æŠ€èµ„è®¯å’Œè¶‹åŠ¿",
    "theme": "github"
  }'
```

**å“åº”**:
```json
{
  "success": true,
  "message": "Channel created",
  "channel": {
    "id": "tech",
    "name": "ç§‘æŠ€é¢‘é“",
    "description": "æœ€æ–°ç§‘æŠ€èµ„è®¯å’Œè¶‹åŠ¿",
    "theme": "github",
    "language": "zh-CN",
    "maxPosts": null,
    "createdAt": "2025-01-15T10:00:00.000Z",
    "updatedAt": "2025-01-15T10:00:00.000Z"
  }
}
```

---

### 2. å‘å¸ƒæ–‡ç« 

**ç«¯ç‚¹**: `POST /api/webhook`

**é‰´æƒ**: éœ€è¦å…¨å±€ `X-Auth-Token`

**é‡è¦å˜æ›´**: `channel` å‚æ•°ç°åœ¨æ˜¯**å¿…å¡«**çš„ï¼

**è¯·æ±‚ä½“**:
```json
{
  "title": "æ–‡ç« æ ‡é¢˜",
  "link": "https://example.com/article",  // å¯é€‰ï¼Œä¸æä¾›åˆ™è‡ªåŠ¨ç”Ÿæˆå†…éƒ¨é“¾æ¥
  "content": "# Markdown å†…å®¹\n\næ–‡ç« æ­£æ–‡...",
  "channel": "tech",           // å¿…å¡«ï¼Œç›®æ ‡é¢‘é“ ID
  "contentType": "markdown",   // å¯é€‰ï¼Œmarkdown æˆ– html
  "theme": "github",           // å¯é€‰ï¼Œè¦†ç›–é¢‘é“é»˜è®¤ä¸»é¢˜
  "description": "æ‘˜è¦",       // å¯é€‰
  "tags": ["AI", "ç§‘æŠ€"],      // å¯é€‰
  "author": "ä½œè€…å"           // å¯é€‰
}
```

**é‡è¦è¯´æ˜**ï¼š
- `link` å‚æ•°ç°åœ¨æ˜¯**å¯é€‰**çš„
- å¦‚æœä¸æä¾›ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆå†…éƒ¨æ°¸ä¹…é“¾æ¥ï¼š`{FEED_URL}/channels/{channelId}/posts/{postId}`
- è¿™å¯¹ AI ç”Ÿæˆçš„å†…å®¹ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸º AI ç”Ÿæˆçš„å†…å®¹é€šå¸¸æ²¡æœ‰å¤–éƒ¨é“¾æ¥
- è¯¦è§ï¼š[AI å†…å®¹é“¾æ¥å¤„ç†æ–¹æ¡ˆ](./AI_CONTENT_LINKS.md)

**ç¤ºä¾‹ 1ï¼šAI ç”Ÿæˆå†…å®¹ï¼ˆæ— å¤–éƒ¨é“¾æ¥ï¼‰**:
```bash
curl -X POST http://localhost:8765/api/webhook \
  -H "Content-Type: application/json" \
  -H "X-Auth-Token: your-token" \
  -d '{
    "title": "ä»Šæ—¥ AI æ–°é—»æ‘˜è¦",
    "content": "# AI æ–°é—»\n\nä»Šå¤©å‘ç”Ÿçš„é‡è¦äº‹ä»¶...",
    "channel": "tech"
  }'
```

**è‡ªåŠ¨ç”Ÿæˆçš„é“¾æ¥**ï¼š`http://localhost:8765/channels/tech/posts/{uuid}`

**ç¤ºä¾‹ 2ï¼šè½¬è½½å†…å®¹ï¼ˆæœ‰å¤–éƒ¨é“¾æ¥ï¼‰**:
```bash
curl -X POST http://localhost:8765/api/webhook \
  -H "Content-Type: application/json" \
  -H "X-Auth-Token: your-token" \
  -d '{
    "title": "AI æ–°çªç ´",
    "link": "https://example.com/ai-breakthrough",
    "content": "# AI çªç ´\n\nä»Šå¤©å‘ç”Ÿé‡å¤§çªç ´...",
    "channel": "tech"
  }'
```

**å“åº”**:
```json
{
  "success": true,
  "message": "Post added to channel \"tech\"",
  "post": {
    "id": "uuid-here",
    "title": "AI æ–°çªç ´",
    "channel": "tech",
    "pubDate": "2025-01-15T10:05:00.000Z"
  }
}
```

---

### 3. è·å–é¢‘é“åˆ—è¡¨

**ç«¯ç‚¹**: `GET /api/channels`

**é‰´æƒ**: ğŸ”’ éœ€è¦è¶…çº§ç®¡ç†å‘˜ Tokenï¼ˆå¿…éœ€ï¼‰

**è¯´æ˜**: æ­¤æ¥å£ä»…é™è¶…çº§ç®¡ç†å‘˜è®¿é—®ï¼Œç”¨äºç®¡ç†å’ŒæŸ¥çœ‹æ‰€æœ‰é¢‘é“ä¿¡æ¯ã€‚

**ç¤ºä¾‹**:
```bash
curl http://localhost:8765/api/channels \
  -H 'Authorization: Bearer YOUR_AUTH_TOKEN'
```

**å“åº”**:
```json
[
  {
    "id": "default",
    "name": "é»˜è®¤é¢‘é“",
    "description": "AI Briefing - Daily news summaries generated by AI.",
    "theme": "spring",
    "language": "zh-CN",
    "maxPosts": null,
    "token": "ch_xxx",  // è¶…çº§ç®¡ç†å‘˜å¯è§æ‰€æœ‰é¢‘é“ token
    "postCount": 5,
    "createdAt": "2025-01-15T00:00:00.000Z",
    "updatedAt": "2025-01-15T00:00:00.000Z"
  },
  {
    "id": "tech",
    "name": "ç§‘æŠ€é¢‘é“",
    "description": "æœ€æ–°ç§‘æŠ€èµ„è®¯å’Œè¶‹åŠ¿",
    "theme": "github",
    "language": "zh-CN",
    "maxPosts": null,
    "token": "ch_yyy",  // è¶…çº§ç®¡ç†å‘˜å¯è§æ‰€æœ‰é¢‘é“ token
    "postCount": 10,
    "createdAt": "2025-01-15T10:00:00.000Z",
    "updatedAt": "2025-01-15T10:00:00.000Z"
  }
]
```

**é”™è¯¯å“åº”**:
- **401**: ç¼ºå°‘ Authorization header
- **403**: Token æ— æ•ˆæˆ–éè¶…çº§ç®¡ç†å‘˜

---

### 4. è·å–å•ä¸ªé¢‘é“

**ç«¯ç‚¹**: `GET /api/channels/:id`

**é‰´æƒ**: æ— éœ€é‰´æƒï¼ˆå…¬å¼€è®¿é—®ï¼‰

**ç¤ºä¾‹**:
```bash
curl http://localhost:8765/api/channels/tech
```

---

### 5. æ›´æ–°é¢‘é“

**ç«¯ç‚¹**: `PUT /api/channels/:id`

**æ— éœ€é‰´æƒ**ï¼ˆå»ºè®®æœªæ¥æ·»åŠ ï¼‰

**è¯·æ±‚ä½“** (æ‰€æœ‰å­—æ®µå¯é€‰):
```json
{
  "name": "æ–°åç§°",
  "description": "æ–°æè¿°",
  "theme": "spring",
  "language": "en",
  "maxPosts": 200
}
```

**ç¤ºä¾‹**:
```bash
curl -X PUT http://localhost:8765/api/channels/tech \
  -H "Content-Type: application/json" \
  -d '{
    "name": "ç§‘æŠ€é¢‘é“ï¼ˆå·²æ›´æ–°ï¼‰",
    "description": "æ–°çš„æè¿°"
  }'
```

---

### 6. åˆ é™¤é¢‘é“

**ç«¯ç‚¹**: `DELETE /api/channels/:id`

**æ— éœ€é‰´æƒ**ï¼ˆå»ºè®®æœªæ¥æ·»åŠ ï¼‰

**é‡è¦**: åˆ é™¤é¢‘é“ä¼šåˆ é™¤è¯¥é¢‘é“çš„æ‰€æœ‰æ–‡ç« ï¼Œä¸”ä¸å¯æ¢å¤ã€‚ä¸èƒ½åˆ é™¤ `default` é¢‘é“ã€‚

**ç¤ºä¾‹**:
```bash
curl -X DELETE http://localhost:8765/api/channels/tech
```

---

## RSS Feed è®¿é—®

### é¢‘é“ä¸“å± RSS

æ¯ä¸ªé¢‘é“æœ‰ç‹¬ç«‹çš„ RSS Feedï¼š

```
/channels/{channelId}/rss.xml
```

**ç¤ºä¾‹**:
- ç§‘æŠ€é¢‘é“: `http://localhost:8765/channels/tech/rss.xml`
- æ–°é—»é¢‘é“: `http://localhost:8765/channels/news/rss.xml`
- é»˜è®¤é¢‘é“: `http://localhost:8765/channels/default/rss.xml`

### èšåˆ RSS

è·å–æ‰€æœ‰é¢‘é“çš„æœ€æ–°æ–‡ç« ï¼š

```
/rss.xml
```

**ç¤ºä¾‹**: `http://localhost:8765/rss.xml`

---

## å®Œæ•´ä½¿ç”¨ç¤ºä¾‹

### åœºæ™¯ï¼šåˆ›å»ºä¸‰ä¸ªé¢‘é“å¹¶å‘å¸ƒæ–‡ç« 

#### 1. åˆ›å»ºé¢‘é“

```bash
# åˆ›å»ºç§‘æŠ€é¢‘é“
curl -X POST http://localhost:8765/api/channels \
  -H "Content-Type: application/json" \
  -H "X-Auth-Token: your-token" \
  -d '{
    "id": "tech",
    "name": "ç§‘æŠ€é¢‘é“",
    "description": "æœ€æ–°ç§‘æŠ€èµ„è®¯å’Œè¶‹åŠ¿",
    "theme": "github"
  }'

# åˆ›å»ºæ–°é—»é¢‘é“
curl -X POST http://localhost:8765/api/channels \
  -H "Content-Type: application/json" \
  -H "X-Auth-Token: your-token" \
  -d '{
    "id": "news",
    "name": "æ–°é—»é¢‘é“",
    "description": "æ¯æ—¥æ–°é—»æ±‡æ€»",
    "theme": "modern"
  }'

# åˆ›å»ºåšå®¢é¢‘é“
curl -X POST http://localhost:8765/api/channels \
  -H "Content-Type: application/json" \
  -H "X-Auth-Token: your-token" \
  -d '{
    "id": "blog",
    "name": "åšå®¢é¢‘é“",
    "description": "ä¸ªäººåšå®¢æ–‡ç« ",
    "theme": "spring"
  }'
```

#### 2. å‘å¸ƒæ–‡ç« 

```bash
# å‘å¸ƒåˆ°ç§‘æŠ€é¢‘é“
curl -X POST http://localhost:8765/api/webhook \
  -H "Content-Type: application/json" \
  -H "X-Auth-Token: your-token" \
  -d '{
    "title": "GPT-5 å‘å¸ƒ",
    "link": "https://example.com/gpt5",
    "content": "# GPT-5 å‘å¸ƒ\n\nOpenAI ä»Šå¤©å‘å¸ƒäº† GPT-5...",
    "channel": "tech"
  }'

# å‘å¸ƒåˆ°æ–°é—»é¢‘é“
curl -X POST http://localhost:8765/api/webhook \
  -H "Content-Type: application/json" \
  -H "X-Auth-Token: your-token" \
  -d '{
    "title": "ä»Šæ—¥è¦é—»",
    "link": "https://example.com/news",
    "content": "# ä»Šæ—¥è¦é—»\n\n1. ...\n2. ...",
    "channel": "news"
  }'

# å‘å¸ƒåˆ°åšå®¢é¢‘é“
curl -X POST http://localhost:8765/api/webhook \
  -H "Content-Type: application/json" \
  -H "X-Auth-Token: your-token" \
  -d '{
    "title": "æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢",
    "link": "https://example.com/blog/1",
    "content": "# æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢\n\næ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢...",
    "channel": "blog"
  }'
```

#### 3. è®¢é˜… RSS

åœ¨ RSS é˜…è¯»å™¨ä¸­è®¢é˜…ï¼š

- ç§‘æŠ€é¢‘é“: `http://localhost:8765/channels/tech/rss.xml`
- æ–°é—»é¢‘é“: `http://localhost:8765/channels/news/rss.xml`
- åšå®¢é¢‘é“: `http://localhost:8765/channels/blog/rss.xml`
- æ‰€æœ‰æ–‡ç« : `http://localhost:8765/rss.xml`

---

## æ•°æ®å­˜å‚¨

### æ•°æ®ç»“æ„

æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨ `data/data.json`ï¼š

```json
{
  "posts": [
    {
      "id": "uuid",
      "channel": "tech",
      "title": "æ–‡ç« æ ‡é¢˜",
      "link": "https://...",
      "content": "<html>...</html>",
      "contentMarkdown": "# Markdown",
      "summary": "æ‘˜è¦",
      "tags": ["tag1"],
      "author": "ä½œè€…",
      "pubDate": "2025-01-15T10:00:00.000Z"
    }
  ],
  "channels": {
    "tech": {
      "id": "tech",
      "name": "ç§‘æŠ€é¢‘é“",
      "description": "æè¿°",
      "theme": "github",
      "language": "zh-CN",
      "maxPosts": 100,
      "createdAt": "2025-01-15T10:00:00.000Z",
      "updatedAt": "2025-01-15T10:00:00.000Z"
    }
  }
}
```

---

## é”™è¯¯å¤„ç†

### å¸¸è§é”™è¯¯

#### 1. é¢‘é“ä¸å­˜åœ¨
```json
{
  "error": "Channel \"tech\" not found"
}
```
**è§£å†³**: å…ˆåˆ›å»ºé¢‘é“ï¼Œå†å‘å¸ƒæ–‡ç« 

#### 2. é‰´æƒå¤±è´¥
```json
{
  "error": "Unauthorized"
}
```
**è§£å†³**: æ£€æŸ¥ `X-Auth-Token` æ˜¯å¦æ­£ç¡®

#### 3. é¢‘é“å·²å­˜åœ¨
```json
{
  "error": "Channel \"tech\" already exists"
}
```
**è§£å†³**: ä½¿ç”¨ä¸åŒçš„é¢‘é“ IDï¼Œæˆ–æ›´æ–°ç°æœ‰é¢‘é“

#### 4. ä¸èƒ½åˆ é™¤é»˜è®¤é¢‘é“
```json
{
  "error": "Cannot delete default channel"
}
```
**è§£å†³**: é»˜è®¤é¢‘é“ä¸èƒ½åˆ é™¤

---

## è¿ç§»æŒ‡å—

### ä»æ—§ç‰ˆæœ¬å‡çº§

å¦‚æœä½ ä¹‹å‰ä½¿ç”¨çš„æ˜¯å•é¢‘é“ç‰ˆæœ¬ï¼š

1. **å¤‡ä»½æ•°æ®**: å¤‡ä»½ `data/posts.json`

2. **æ›´æ–°ä»£ç **: æ‹‰å–æœ€æ–°ä»£ç 

3. **è¿ç§»æ•°æ®** (å¯é€‰):
   ```bash
   # æ—§æ–‡ç« ä¼šä¿ç•™ï¼Œä½†æ²¡æœ‰ channel å­—æ®µ
   # å»ºè®®é‡æ–°å‘å¸ƒæˆ–æ‰‹åŠ¨è¿ç§»
   ```

4. **æ›´æ–° Webhook è°ƒç”¨**:
   - æ·»åŠ  `channel` å‚æ•°ï¼ˆå¿…å¡«ï¼‰
   - ç¤ºä¾‹ï¼š
     ```bash
     # æ—§ç‰ˆæœ¬
     curl -X POST http://localhost:8765/api/webhook \
       -H "X-Auth-Token: your-token" \
       -d '{"title": "...", "link": "...", "content": "..."}'

     # æ–°ç‰ˆæœ¬ï¼ˆå¿…é¡»æ·»åŠ  channelï¼‰
     curl -X POST http://localhost:8765/api/webhook \
       -H "X-Auth-Token: your-token" \
       -d '{"title": "...", "link": "...", "content": "...", "channel": "default"}'
     ```

---

## ç¯å¢ƒå˜é‡

```bash
# æœåŠ¡é…ç½®
PORT=8765                           # æœåŠ¡ç«¯å£

# é‰´æƒé…ç½®
AUTH_TOKEN=your-secret-token        # å…¨å±€é‰´æƒ Token

# RSS Feed é…ç½®
FEED_TITLE=AI Briefing              # èšåˆ Feed æ ‡é¢˜
FEED_DESCRIPTION=Daily summaries    # èšåˆ Feed æè¿°
FEED_URL=http://localhost:8765      # æœåŠ¡ URL

# é»˜è®¤é¢‘é“
DEFAULT_CHANNEL=default             # é»˜è®¤é¢‘é“ ID
```

---

## æœ€ä½³å®è·µ

### 1. é¢‘é“ ID å‘½å

ä½¿ç”¨ç®€æ´çš„è‹±æ–‡ IDï¼š
- âœ… `tech`, `news`, `blog`, `docs`
- âŒ `ç§‘æŠ€é¢‘é“`, `æ–°é—»å¿«è®¯`, `æˆ‘çš„åšå®¢`

### 2. é¢‘é“è§„åˆ’

æ ¹æ®å†…å®¹ç±»å‹åˆ’åˆ†é¢‘é“ï¼š
- æŒ‰ä¸»é¢˜ï¼š`tech`, `finance`, `sports`
- æŒ‰æ¥æºï¼š`twitter`, `blog`, `newsletter`
- æŒ‰è¯­è¨€ï¼š`zh`, `en`, `ja`

### 3. ä¸»é¢˜é€‰æ‹©

ä¸ºä¸åŒé¢‘é“é€‰æ‹©ä¸åŒä¸»é¢˜ï¼š
- æŠ€æœ¯æ–‡æ¡£ï¼š`github`, `monokai`
- æ–°é—»èµ„è®¯ï¼š`modern`, `clean`
- ä¸ªäººåšå®¢ï¼š`spring`, `warm`

### 4. æ–‡ç« æ•°é‡é™åˆ¶

æ ¹æ®æ›´æ–°é¢‘ç‡è®¾ç½® `maxPosts`ï¼š
- é«˜é¢‘æ›´æ–°ï¼š`50-100`
- ä½é¢‘æ›´æ–°ï¼š`20-50`

---

## å¸¸è§é—®é¢˜

### Q: å¯ä»¥ä¿®æ”¹é¢‘é“ ID å—ï¼Ÿ
**A**: ä¸å¯ä»¥ã€‚é¢‘é“ ID åˆ›å»ºåä¸èƒ½ä¿®æ”¹ï¼Œå¦‚éœ€æ›´æ”¹è¯·åˆ›å»ºæ–°é¢‘é“ã€‚

### Q: åˆ é™¤é¢‘é“çš„æ–‡ç« èƒ½æ¢å¤å—ï¼Ÿ
**A**: ä¸èƒ½ã€‚åˆ é™¤é¢‘é“ä¼šæ°¸ä¹…åˆ é™¤è¯¥é¢‘é“çš„æ‰€æœ‰æ–‡ç« ï¼Œæ“ä½œå‰è¯·å¤‡ä»½ã€‚

### Q: å¯ä»¥ä¸ºä¸åŒé¢‘é“è®¾ç½®ä¸åŒçš„é‰´æƒ Token å—ï¼Ÿ
**A**: ç›®å‰æ‰€æœ‰é¢‘é“å…±äº«ä¸€ä¸ªå…¨å±€ Tokenã€‚æœªæ¥ç‰ˆæœ¬å¯èƒ½æ”¯æŒç‹¬ç«‹ Tokenã€‚

### Q: RSS èšåˆ Feed åŒ…å«å“ªäº›æ–‡ç« ï¼Ÿ
**A**: åŒ…å«æ‰€æœ‰é¢‘é“çš„æœ€æ–°æ–‡ç« ï¼ŒæŒ‰æ—¶é—´å€’åºæ’åˆ—ã€‚

### Q: å¦‚ä½•å°†æ—§æ•°æ®è¿ç§»åˆ°æ–°é¢‘é“ï¼Ÿ
**A**:
1. è¯»å– `data/posts.json`
2. ä¸ºæ¯ç¯‡æ–‡ç« æ·»åŠ  `channel` å­—æ®µ
3. è°ƒç”¨ API é‡æ–°å‘å¸ƒï¼Œæˆ–ç›´æ¥ä¿®æ”¹ `data/data.json`

---

## æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·è®¿é—®ï¼š
- GitHub Issues: [é“¾æ¥]
- æ–‡æ¡£: [é“¾æ¥]
- ç¤ºä¾‹ä»£ç : `docs/examples/`
